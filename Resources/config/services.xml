<?xml version="1.0" encoding="UTF-8"?>
<container xmlns="http://www.symfony-project.org/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.symfony-project.org/schema/dic/services http://www.symfony-project.org/schema/dic/services/services-1.0.xsd">

	<parameters>
		<parameter key="request.class">Bundle\WebServiceBundle\Soap\SoapRequest</parameter>
		
		<parameter key="webservice.binder.request.class">Bundle\WebServiceBundle\ServiceBinding\DocumentLiteralWrappedRequestMessageBinder</parameter>
		<parameter key="webservice.binder.response.class">Bundle\WebServiceBundle\ServiceBinding\DocumentLiteralWrappedResponseMessageBinder</parameter>
		
		<parameter key="webservice.definition.class">Bundle\WebServiceBundle\ServiceDefinition\ServiceDefinition</parameter>
		<parameter key="webservice.definition.loader.class">Bundle\WebServiceBundle\ServiceDefinition\Loader\XmlFileLoader</parameter>
		<parameter key="webservice.definition.dumper.class">Bundle\WebServiceBundle\ServiceDefinition\Dumper\WsdlFileDumper</parameter>
	</parameters>
	
	<services>        
		<service id="webservice_controller" class="Bundle\WebServiceBundle\Controller\SoapWebServiceController">
            <argument type="service" id="webservice.binder" />
            <argument type="service" id="webservice.server.factory" />
            <argument type="service" id="http_kernel" />
		</service>
		
		<service id="webservice.binder" class="Bundle\WebServiceBundle\ServiceBinding\ServiceBinder">
			<argument type="service" id="webservice.definition" />
			
			<argument type="service" id="webservice.binder.request" />
			<argument type="service" id="webservice.binder.response" />
		</service>
		
		<service id="webservice.binder.request" class="%webservice.binder.request.class%" />
		<service id="webservice.binder.response" class="%webservice.binder.response.class%" />
		
		<service id="webservice.server.factory" class="Bundle\WebServiceBundle\Soap\SoapServerFactory">
            <argument type="service" id="webservice.definition" />
            <argument type="service" id="webservice.converter.repository" />
            <argument type="service" id="webservice.definition.dumper" />
		</service>
		
		<service id="webservice.converter.repository" class="Bundle\WebServiceBundle\Converter\ConverterRepository">
			<call method="registerTypeConverterServices">
				<argument type="service" id="service_container" />
			</call>
		</service>
		
		<service id="webservice.definition" class="%webservice.definition.class%" shared="true">
			<argument type="string">%webservice.definition.name%</argument>
			<argument type="string">%webservice.definition.namespace%</argument>
			<configurator service="webservice.definition.loader" method="loadServiceDefinition" />
		</service>
		<service id="webservice.definition.loader" class="%webservice.definition.loader.class%">
			<argument type="string">%webservice.definition.resource%</argument>
		</service>
		<service id="webservice.definition.dumper" class="%webservice.definition.dumper.class%">
			<argument type="string">%webservice.definition.wsdl%</argument>
		</service>
	</services>
</container>
